Free Space management
---



## 空闲表 free list
在堆上管理空闲空间的数据结构

### 分割和合并 
- 分割splitting
找到一块可以满足请求的空闲空间，将其分割成两块，第一块返回给用户，剩下的第二块留在列表中

- 合并coalescing
空间归还时查看是否与原有空闲块相邻，如有则合并

### 数据结构

头块
```C
struct header_t {
    int size; // 空间大小
    int magic // 幻数，用来检查完整性
}
```

malloc的时候会多申请8个字节来写入头块信息，记录申请的空间大小


### 堆分配策略

- best fit最优匹配: 遍历整个空间列表，找出最接近请求的空闲块
- first fit 首次匹配：找到第一个大于等于请求的空闲块
- next fit下次匹配: 类似firt fit,但不是每次从空闲表的开始找起，而是多维护一个指针记录上次查找结束的位置 



